<atlassian-plugin key="${project.groupId}.${project.artifactId}" name="${project.name}" plugins-version="2">
    <plugin-info>
        <description>${project.description}</description>
        <version>${project.version}</version>
        <vendor name="${project.organization.name}" url="${project.organization.url}" />
    </plugin-info>

    <described-module-type key="webhook" name="Web Hook" class="com.atlassian.webhooks.plugin.module.WebHookModuleDescriptor"
                           schema-transformer-class="com.atlassian.webhooks.plugin.module.WebHookSchemaFactory">
        <description>Registration for a web hook callback from an internal event</description>
    </described-module-type>

    <component key="moduleDescriptorWebHookRegistry"
               class="com.atlassian.webhooks.plugin.ModuleDescriptorWebHookRegistryImpl"
               interface="com.atlassian.webhooks.spi.provider.ModuleDescriptorWebHookConsumerRegistry"
               public="true" />

    <component key="pluginLauncher" class="com.atlassian.webhooks.plugin.PluginLauncher" public="true">
        <interface>org.springframework.beans.factory.InitializingBean</interface>
        <interface>org.springframework.beans.factory.DisposableBean</interface>
    </component>

    <!-- Refapp -->
    <component key="refappThreadLocalContextManager" class="com.atlassian.webhooks.plugin.refapp.RefappThreadLocalContextManager"
               interface="com.atlassian.httpclient.spi.ThreadLocalContextManager" public="true" application="refapp"/>
    <component-import key="refappAuthenticationContext" interface="com.atlassian.seraph.auth.AuthenticationContext" application="refapp"/>

    <!-- Confluence -->
    <component key="confluenceThreadContextManager" class="com.atlassian.webhooks.plugin.confluence.ConfluenceThreadLocalContextManager"
               interface="com.atlassian.httpclient.spi.ThreadLocalContextManager" public="true" application="confluence"/>

    <!-- JIRA -->
    <component key="jiraThreadContextManager" class="com.atlassian.webhooks.plugin.jira.JiraThreadLocalContextManager"
               interface="com.atlassian.httpclient.spi.ThreadLocalContextManager" public="true" application="jira"/>

    <component-import key="jiraAuthenticationContext" interface="com.atlassian.jira.security.JiraAuthenticationContext" application="jira" />
    <component-import key="jiraVelocityRequestContextFactory" interface="com.atlassian.jira.util.velocity.VelocityRequestContextFactory" application="jira" />

    <component-import key="pluginEventManager" interface="com.atlassian.plugin.event.PluginEventManager" />

    <rest key="webhooksRest" path="/webhooks" version="1.0" description="Provides webhook registration services." />

    <ao key="webhooks-ao-module" name="Active Objects Module">
        <description>Datastore for persistent webhooks.</description>
        <entity>com.atlassian.webhooks.plugin.ao.WebHookAO</entity>
    </ao>

</atlassian-plugin>